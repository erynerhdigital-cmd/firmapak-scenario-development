<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>FirmaPak | Scenario Development Consultation | Virtual Instinct</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --vi-navy:#050b18;
      --vi-navy-soft:#0c1b2a;
      --vi-slate:#101820;
      --vi-ink:#111827;
      --vi-teal:#18b7b4;
      --vi-blue:#2e7dd7;
      --vi-green:#41b66c;
      --vi-text:#e5ecf5;
      --vi-muted:#94a3b8;
      --vi-border:#1f2933;
      --card-radius:18px;
      --shadow-soft:0 18px 40px rgba(0,0,0,.55);
    }

    * {
      box-sizing:border-box;
      margin:0;
      padding:0;
    }

    body {
      font-family:"Inter",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      background:radial-gradient(circle at top,#192a3d 0,#050b18 45%,#020617 100%);
      color:var(--vi-text);
      min-height:100vh;
      display:flex;
      align-items:stretch;
      justify-content:center;
    }

    .page-shell {
      width:100%;
      min-height:100vh;
      padding:24px 16px 40px;
      display:flex;
      justify-content:center;
    }

    .layout {
      width:100%;
      max-width:1120px;
      display:flex;
      flex-direction:column;
      gap:20px;
    }

    /* TOP BAR: LOGOS ONLY */
    .top-bar {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
    }

    .logo-row {
      display:flex;
      align-items:center;
      gap:12px;
    }

    .firmapak-logo {
      height:32px;
      width:auto;
    }

    .vi-logo {
      height:26px;
      width:auto;
    }

    /* HERO SECTION */
    .hero {
      border-radius:24px;
      padding:28px 24px 26px;
      background:radial-gradient(circle at top left,rgba(59,130,246,.28),transparent 55%),
                  radial-gradient(circle at bottom right,rgba(56,189,248,.18),transparent 60%),
                  linear-gradient(145deg,#020617,#020617 35%,#020617);
      border:1px solid rgba(148,163,184,.35);
      box-shadow:var(--shadow-soft);
    }

    .hero-title {
      font-family:"Montserrat",system-ui;
      font-size:32px;
      line-height:1.2;
      margin-bottom:8px;
      letter-spacing:.02em;
    }

    .hero-title span.highlight {
      color:#4f8cff;
    }

    .hero-subtitle {
      font-size:14px;
      color:var(--vi-muted);
      max-width:640px;
      margin-bottom:24px;
    }

    .hero-tagline {
      text-transform:uppercase;
      letter-spacing:.18em;
      font-size:11px;
      color:rgba(148,163,184,.9);
      margin-bottom:12px;
    }

    .hero-grid {
      display:grid;
      grid-template-columns:repeat(3,minmax(0,1fr));
      gap:14px;
      margin-bottom:20px;
    }

    @media (max-width:900px){
      .hero-grid {
        grid-template-columns:1fr;
      }
    }

    .hero-card {
      border-radius:18px;
      padding:14px 14px 16px;
      background:rgba(15,23,42,.96);
      border:1px solid rgba(51,65,85,.9);
    }

    .hero-card-title {
      font-size:13px;
      font-weight:600;
      margin-bottom:4px;
    }

    .hero-card-sub {
      font-size:12px;
      color:var(--vi-muted);
    }

    .hero-icon {
      width:24px;
      height:24px;
      border-radius:999px;
      margin-bottom:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:rgba(37,99,235,.2);
      font-size:14px;
    }

    .hero-bottom {
      display:grid;
      grid-template-columns: minmax(0,2fr) minmax(0,1.4fr);
      gap:16px;
      align-items:flex-start;
      margin-top:4px;
    }

    @media (max-width:900px){
      .hero-bottom {
        grid-template-columns:1fr;
      }
    }

    .expect-card {
      border-radius:18px;
      padding:14px 16px 12px;
      background:rgba(15,23,42,.96);
      border:1px solid rgba(51,65,85,.9);
      font-size:12px;
    }

    .expect-title {
      font-size:12px;
      font-weight:600;
      margin-bottom:8px;
    }

    .expect-columns {
      display:grid;
      grid-template-columns: repeat(2,minmax(0,1fr));
      gap:10px;
    }

    @media (max-width:600px){
      .expect-columns {
        grid-template-columns:1fr;
      }
    }

    .expect-section-title {
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.16em;
      color:rgba(148,163,184,.9);
      margin-bottom:6px;
    }

    .expect-list {
      list-style:none;
      padding-left:0;
    }

    .expect-list li {
      display:flex;
      align-items:flex-start;
      gap:6px;
      margin-bottom:4px;
    }

    .expect-list li span.bullet {
      font-size:12px;
      margin-top:1px;
    }

    .hero-cta-row {
      margin-top:16px;
      display:flex;
      align-items:center;
      justify-content:flex-start;
      gap:10px;
    }

    .btn {
      border-radius:999px;
      border:none;
      cursor:pointer;
      font-size:13px;
      font-weight:500;
      padding:9px 18px;
      display:inline-flex;
      align-items:center;
      gap:6px;
      white-space:nowrap;
      transition:background .15s ease,transform .08s ease,box-shadow .15s ease,opacity .15s ease;
      font-family:inherit;
    }

    .btn-primary {
      background:linear-gradient(135deg,var(--vi-teal),var(--vi-blue));
      color:#0b1220;
      box-shadow:0 10px 25px rgba(15,118,110,.6);
    }

    .btn-primary:hover {
      transform:translateY(-1px);
      box-shadow:0 14px 30px rgba(8,47,73,.8);
    }

    .hero-cta-hint {
      font-size:11px;
      color:var(--vi-muted);
    }

    /* CONSULTATION SECTION */
    .consultation-section {
      margin-top:18px;
    }

    .content-row {
      display:grid;
      grid-template-columns: minmax(0,1.2fr) minmax(0,2fr);
      gap:24px;
      align-items:flex-start;
    }

    @media (max-width:900px){
      .content-row {
        grid-template-columns:minmax(0,1fr);
      }
    }

    .intro-panel {
      border-radius:var(--card-radius);
      padding:18px 18px 20px;
      background:radial-gradient(circle at top left,rgba(56,189,248,.18),transparent 55%),
                  radial-gradient(circle at bottom right,rgba(16,185,129,.2),transparent 60%),
                  linear-gradient(145deg,rgba(15,23,42,.96),rgba(15,23,42,.98));
      border:1px solid rgba(148,163,184,.32);
      box-shadow:var(--shadow-soft);
    }

    .intro-panel h2 {
      font-family:"Montserrat",system-ui;
      font-size:18px;
      letter-spacing:.03em;
      text-transform:uppercase;
      margin-bottom:10px;
    }

    .intro-subtitle {
      font-size:13px;
      color:var(--vi-muted);
      margin-bottom:12px;
    }

    .scenario-chips {
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-bottom:14px;
    }

    .chip {
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.12em;
      padding:6px 9px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.5);
      background:rgba(15,23,42,.9);
      color:#e5ecf5;
    }

    .intro-note {
      font-size:12px;
      line-height:1.5;
      color:var(--vi-muted);
      margin-bottom:16px;
    }

    .meta-box {
      margin-top:10px;
      padding:10px 12px;
      border-radius:14px;
      background:rgba(15,23,42,.9);
      border:1px solid rgba(148,163,184,.35);
      font-size:11px;
      color:var(--vi-muted);
    }

    .meta-row {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      margin-bottom:6px;
    }

    .meta-label {
      text-transform:uppercase;
      letter-spacing:.14em;
      font-size:10px;
      color:rgba(148,163,184,.9);
    }

    .meta-value {
      font-size:11px;
      color:#e5ecf5;
    }

    .meta-checklist {
      margin-top:4px;
      padding-left:16px;
    }

    .meta-checklist li {
      margin-bottom:4px;
    }

    .wizard-shell {
      position:relative;
      min-height:360px;
    }

    .card {
      position:relative;
      border-radius:var(--card-radius);
      background:radial-gradient(circle at top left,rgba(56,189,248,.16),transparent 54%),
                  radial-gradient(circle at bottom right,rgba(45,212,191,.14),transparent 58%),
                  linear-gradient(160deg,#020617,#020617 5%,#020617 40%,#020617 100%);
      border:1px solid rgba(51,65,85,.95);
      box-shadow:var(--shadow-soft);
      padding:18px 18px 16px;
      overflow:hidden;
    }

    .card::before {
      content:"";
      position:absolute;
      inset:0;
      background:radial-gradient(circle at top,rgba(59,130,246,.22),transparent 60%);
      opacity:.5;
      pointer-events:none;
      mix-blend-mode:soft-light;
    }

    .card-inner {
      position:relative;
      z-index:1;
    }

    .step-label {
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.16em;
      color:var(--vi-muted);
      margin-bottom:6px;
    }

    .step-title {
      font-family:"Montserrat",system-ui;
      font-size:18px;
      margin-bottom:4px;
    }

    .step-subtitle {
      font-size:13px;
      color:var(--vi-muted);
      margin-bottom:12px;
    }

    .fields-grid {
      display:flex;
      flex-direction:column;
      gap:12px;
      margin-bottom:14px;
    }

    .field-group label {
      display:block;
      font-size:12px;
      margin-bottom:4px;
      color:#e5ecf5;
      font-weight:500;
    }

    .field-group small {
      display:block;
      font-size:11px;
      color:var(--vi-muted);
      margin-bottom:4px;
    }

    .field-input,
    .field-textarea {
      width:100%;
      border-radius:11px;
      border:1px solid rgba(71,85,105,.95);
      padding:9px 10px;
      background:rgba(15,23,42,.96);
      color:#e5ecf5;
      font-size:13px;
      outline:none;
      transition:border-color .15s ease,box-shadow .15s ease,background .15s ease;
      resize:vertical;
      min-height:40px;
    }

    .field-textarea {
      min-height:90px;
      max-height:260px;
    }

    .field-input:focus,
    .field-textarea:focus {
      border-color:var(--vi-teal);
      box-shadow:0 0 0 1px rgba(34,211,238,.5);
      background:#020617;
    }

    .field-input::placeholder,
    .field-textarea::placeholder {
      color:rgba(148,163,184,.7);
    }

    .progress-row {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-top:4px;
    }

    .progress-meta {
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width:0;
      flex:1;
    }

    .progress-bar-shell {
      position:relative;
      width:100%;
      height:6px;
      border-radius:999px;
      background:rgba(15,23,42,.95);
      overflow:hidden;
      border:1px solid rgba(30,64,175,.8);
    }

    .progress-bar-fill {
      position:absolute;
      inset:0;
      width:0;
      border-radius:999px;
      background:linear-gradient(90deg,var(--vi-teal),var(--vi-blue));
      transition:width .2s ease-out;
    }

    .progress-text {
      font-size:11px;
      color:var(--vi-muted);
    }

    .nav-buttons {
      display:flex;
      align-items:center;
      gap:8px;
    }

    .btn-secondary {
      background:rgba(15,23,42,.95);
      color:var(--vi-text);
      border:1px solid rgba(148,163,184,.75);
    }

    .btn-secondary:hover {
      background:rgba(15,23,42,1);
    }

    .btn:disabled {
      opacity:.45;
      cursor:default;
      transform:none;
      box-shadow:none;
    }

    .status-message {
      margin-top:10px;
      font-size:12px;
    }

    .status-success {
      color:#4ade80;
    }

    .status-error {
      color:#f97373;
    }

    .status-neutral {
      color:var(--vi-muted);
    }

    .required-badge {
      color:#f97373;
      margin-left:2px;
    }

    .hidden {
      display:none;
    }
  </style>
</head>
<body>
  <div class="page-shell">
    <div class="layout">
      <!-- TOP LOGO BAR -->
      <div class="top-bar">
        <div class="logo-row">
          <img class="firmapak-logo" src="https://23746819.fs1.hubspotusercontent-na1.net/hubfs/23746819/Firmapak%20-%20White%20Logo.webp" alt="FirmaPak Logo">
        </div>
        <img class="vi-logo" src="https://23746819.fs1.hubspotusercontent-na1.net/hubfs/23746819/Virtual%20Instinct-03.webp" alt="Virtual Instinct Logo">
      </div>

      <!-- HERO LANDING PAGE -->
      <section class="hero">
        <div class="hero-tagline">Consultation to Develop</div>
        <h1 class="hero-title">
          Virtual Practice <span class="highlight">Scenarios</span>
        </h1>
        <p class="hero-subtitle">
          Complete this consultation form to help us build customized sales training scenarios tailored to FirmaPak‚Äôs unique challenges and opportunities.
        </p>

        <div class="hero-grid">
          <div class="hero-card">
            <div class="hero-icon">üìã</div>
            <div class="hero-card-title">Qualifying &amp; Needs Analysis</div>
            <div class="hero-card-sub">
              Master early-stage conversations and uncover customer needs effectively.
            </div>
          </div>
          <div class="hero-card">
            <div class="hero-icon">üìë</div>
            <div class="hero-card-title">Proposal Review to Close</div>
            <div class="hero-card-sub">
              Navigate negotiations and close deals with confidence.
            </div>
          </div>
          <div class="hero-card">
            <div class="hero-icon">‚ö°</div>
            <div class="hero-card-title">The Medley (Full-Flow)</div>
            <div class="hero-card-sub">
              Practice complete sales cycles from start to finish.
            </div>
          </div>
        </div>

        <div class="hero-bottom">
          <div class="expect-card">
            <div class="expect-title">What to Expect</div>
            <div class="expect-columns">
              <div>
                <div class="expect-section-title">This form covers</div>
                <ul class="expect-list">
                  <li><span class="bullet">‚úÖ</span><span>Customer profile &amp; ideal customer analysis</span></li>
                  <li><span class="bullet">‚úÖ</span><span>Customer personas &amp; buying dynamics</span></li>
                  <li><span class="bullet">‚úÖ</span><span>Qualifying &amp; needs analysis scenarios</span></li>
                  <li><span class="bullet">‚úÖ</span><span>Proposal review &amp; closing scenarios</span></li>
                </ul>
              </div>
              <div>
                <div class="expect-section-title">Time &amp; progress</div>
                <ul class="expect-list">
                  <li><span class="bullet">‚è±</span><span>Estimated time: 20‚Äì30 minutes</span></li>
                  <li><span class="bullet">üìÇ</span><span>7 sections to complete</span></li>
                  <li><span class="bullet">üìà</span><span>Progress indicator on each step</span></li>
                  <li><span class="bullet">‚úâÔ∏è</span><span>Responses emailed to the Virtual Instinct team</span></li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="hero-cta-row">
          <button id="start-btn" class="btn btn-primary">Start Consultation</button>
          <span class="hero-cta-hint">Questions will appear below once you start.</span>
        </div>
      </section>

      <!-- CONSULTATION SECTION (HIDDEN UNTIL START) -->
      <section id="consultation-section" class="consultation-section hidden">
        <div class="content-row">
          <!-- LEFT: INTRO CARD -->
          <aside class="intro-panel">
            <h2>Scenario Design Intake</h2>
            <p class="intro-subtitle">
              Use this intake to capture how your customers think, how deals are won or lost,
              and the exact moments your sales team needs to rehearse.
            </p>

            <div class="scenario-chips">
              <span class="chip">Qualifying &amp; Needs Analysis</span>
              <span class="chip">Proposal Review to Close</span>
              <span class="chip">Full-Flow Medley</span>
            </div>

            <p class="intro-note">
              Your responses will be translated into live practice scenarios and Key Moments inside
              Virtual Instinct. We‚Äôll combine your lost deals, competitive dynamics, and internal
              sales patterns to build realistic simulations.
            </p>

            <div class="meta-box">
              <div class="meta-row">
                <span class="meta-label">Delivered To</span>
                <span class="meta-value">Virtual Instinct Scenario Design Team</span>
              </div>
              <div class="meta-row">
                <span class="meta-label">What Happens Next</span>
                <span class="meta-value">We write scripts, build role-play flows &amp; schedule sessions.</span>
              </div>
              <ul class="meta-checklist">
                <li>‚úî On submit, answers are sent to a secure webhook.</li>
                <li>‚úî Zapier handles email delivery &amp; HubSpot contact creation.</li>
              </ul>
            </div>
          </aside>

          <!-- RIGHT: WIZARD CARD -->
          <main class="wizard-shell">
            <section class="card" aria-live="polite">
              <div class="card-inner">
                <div id="step-header"></div>
                <form id="wizard-form">
                  <div id="fields-container" class="fields-grid"></div>
                </form>

                <div class="progress-row">
                  <div class="progress-meta">
                    <div class="progress-bar-shell" aria-hidden="true">
                      <div id="progress-bar" class="progress-bar-fill"></div>
                    </div>
                    <div id="progress-text" class="progress-text"></div>
                  </div>
                  <div class="nav-buttons">
                    <button type="button" id="back-btn" class="btn btn-secondary">‚Üê Back</button>
                    <button type="button" id="next-btn" class="btn btn-primary">Next ‚Üí</button>
                  </div>
                </div>

                <div id="status" class="status-message status-neutral"></div>
              </div>
            </section>
          </main>
        </div>
      </section>
    </div>
  </div>

  <script>
    /********************************************************
     * CONFIG: YOUR ZAPIER WEBHOOK
     ********************************************************/
    const WEBHOOK_URL = "https://hooks.zapier.com/hooks/catch/25619352/ufuigki/";

    /********************************************************
     * STEP DEFINITIONS ‚Äì ALL QUESTIONS
     ********************************************************/
    const steps = [
      {
        id: "pre_participants",
        section: "Pre-Consultation",
        title: "Who will be practicing?",
        subtitle: "List the salespeople who will participate so we can align scenarios with your team.",
        fields: [
          {
            name: "participants",
            label: "Names & emails of all participating salespeople",
            type: "textarea",
            required: false,
            helper: "You can paste a list or export from your CRM.",
            placeholder: "Example:\nJane Smith ‚Äì jane@firmapak.com\nAlex Johnson ‚Äì alex@firmapak.com"
          }
        ]
      },

      /************ 1. CUSTOMER PROFILE ************/
      {
        id: "cust_icp",
        section: "1. Customer Profile",
        title: "Ideal Customer Profile",
        subtitle: "Understand FirmaPak‚Äôs ideal customer and where we create the most value.",
        fields: [
          {
            name: "icp_who",
            label: "Who is FirmaPak‚Äôs Ideal Customer Profile (ICP)?",
            type: "textarea",
            required: false,
            placeholder: "Describe the companies and buyers who are the best fit for FirmaPak."
          },
          {
            name: "icp_fit",
            label: "What industries, company sizes, or product types best fit?",
            type: "textarea",
            required: false,
            placeholder: "Industries, annual revenue, plant size, run sizes, product categories..."
          }
        ]
      },
      {
        id: "cust_lost_deals",
        section: "1. Customer Profile",
        title: "Lost deals & silent proposals",
        subtitle: "We‚Äôll turn real lost opportunities into realistic 'what actually happens' scenarios.",
        fields: [
          {
            name: "lost_deals_list",
            label: "List four (4) vertical-market companies where you recently:",
            type: "textarea",
            required: false,
            helper: "Include if you lost the deal, were ghosted, or lost to a competitor.",
            placeholder: "For each: vertical, company, outcome (lost/ghosted/competitor)."
          },
          {
            name: "lost_deals_details",
            label: "For each of these deals, who was the main contact (title/function)?",
            type: "textarea",
            required: false,
            placeholder: "Brand Manager, Procurement, Plant Manager, etc."
          },
          {
            name: "lost_deals_reason",
            label: "Why do you believe the deals were lost?",
            type: "textarea",
            required: false,
            placeholder: "Pricing, responsiveness, technical fit, perceived risk, internal politics..."
          },
          {
            name: "lost_deals_patterns",
            label: "What patterns or themes do you see in lost opportunities?",
            type: "textarea",
            required: false,
            placeholder: "Common reasons, stages where they fall off, repeated objections, etc."
          },
          {
            name: "lost_deals_proposals",
            label: "Can we get copies of the proposals used in these four deals?",
            type: "textarea",
            required: false,
            placeholder: "Where they‚Äôre stored and how you can share them (drive, email, etc.)."
          }
        ]
      },
      {
        id: "cust_competitive",
        section: "1. Customer Profile",
        title: "Competitive landscape",
        subtitle: "Who do your buyers compare you to, and why?",
        fields: [
          {
            name: "competitors",
            label: "Who are your biggest competitors?",
            type: "textarea",
            required: false,
            placeholder: "List by name and vertical if relevant."
          },
          {
            name: "competitors_better",
            label: "What do buyers believe these competitors do better?",
            type: "textarea",
            required: false,
            placeholder: "What you hear directly from prospects and customers."
          },
          {
            name: "competitors_fail",
            label: "Where do those bigger competitors fail or fall short?",
            type: "textarea",
            required: false,
            placeholder: "Service gaps, inflexibility, lack of innovation, communication issues..."
          }
        ]
      },
      {
        id: "cust_use_cases",
        section: "1. Customer Profile",
        title: "Use cases & vertical dynamics",
        subtitle: "Anchor practice in real-world blow-mold injection scenarios.",
        fields: [
          {
            name: "use_cases",
            label: "What are the primary use cases for blow-mold injection plastics?",
            type: "textarea",
            required: false,
            placeholder: "Applications, product types, packaging use cases, etc."
          },
          {
            name: "vertical_unique",
            label: "What makes FirmaPak unique in certain verticals or markets?",
            type: "textarea",
            required: false,
            placeholder: "Capabilities, lead times, engineering support, sustainability, etc."
          },
          {
            name: "differentiators",
            label: "What differentiators resonate most with customers?",
            type: "textarea",
            required: false,
            placeholder: "The points that actually land during sales conversations."
          },
          {
            name: "cust_notes",
            label: "Notes for Customer Profile.",
            type: "textarea",
            required: false,
            placeholder: "Anything else we should know before building Customer Profile scenarios."
          },
          {
            name: "cust_additional_questions",
            label: "Additional questions you want to explore in this area.",
            type: "textarea",
            required: false,
            placeholder: "Use this space for any 'we should probably talk about...' items."
          }
        ]
      },

      /************ 2. PERSONAS & BUYING DYNAMICS ************/
      {
        id: "personas_profiles",
        section: "2. Customer Personas & Buying Dynamics",
        title: "Typical buyer profiles",
        subtitle: "Who is in the room at qualification and proposal stages?",
        fields: [
          {
            name: "personas_common",
            label: "Who are the most common buyers at the qualification and proposal stages?",
            type: "textarea",
            required: false,
            placeholder: "Brand Managers, Procurement, Plant Managers, Supply Chain, Sustainability Leaders..."
          },
          {
            name: "personas_education_experience",
            label: "What is their education and experience level?",
            type: "textarea",
            required: false,
            placeholder: "Typical background, technical vs commercial orientation, years in role."
          },
          {
            name: "personas_roles",
            label: "What is their role or job function?",
            type: "textarea",
            required: false,
            placeholder: "How their job description and KPIs connect to your work."
          }
        ]
      },
      {
        id: "personas_dynamics",
        section: "2. Customer Personas & Buying Dynamics",
        title: "Role-based decision dynamics",
        subtitle: "How each persona sees the decision and evaluates suppliers.",
        fields: [
          {
            name: "personas_view_purchase",
            label: "How does each persona view the purchase differently?",
            type: "textarea",
            required: false,
            placeholder: "What matters most to each (cost, risk, innovation, operations, etc.)."
          },
          {
            name: "personas_evaluate_suppliers",
            label: "How do they gather information and evaluate suppliers?",
            type: "textarea",
            required: false,
            placeholder: "RFPs, trials, audits, referrals, data they request..."
          },
          {
            name: "personas_internal_pressures",
            label: "What internal pressures do they experience? (Revenue, risk mitigation, on-time delivery, sustainability requirements, etc.)",
            type: "textarea",
            required: false,
            placeholder: "What they‚Äôre accountable for internally and what they worry about most."
          }
        ]
      },
      {
        id: "personas_risk",
        section: "2. Customer Personas & Buying Dynamics",
        title: "Risk perception & reassurance",
        subtitle: "Scripted objections and proof points will come from here.",
        fields: [
          {
            name: "risk_worries",
            label: "What worries them most about choosing a smaller supplier?",
            type: "textarea",
            required: false,
            placeholder: "Capacity, reliability, financial strength, transition risk, etc."
          },
          {
            name: "risk_proof",
            label: "What assurances or proof points do they require?",
            type: "textarea",
            required: false,
            placeholder: "Certifications, references, SLAs, audits, case studies..."
          },
          {
            name: "personas_notes",
            label: "Notes for Customer Personas & Buying Dynamics.",
            type: "textarea",
            required: false,
            placeholder: "Anything else about internal politics, influencers, or champions."
          },
          {
            name: "personas_additional_questions",
            label: "Additional questions you want to explore about personas.",
            type: "textarea",
            required: false,
            placeholder: "Other angles we should build into persona-driven scenarios."
          }
        ]
      },

      /************ 3. QUALIFYING & NEEDS ANALYSIS ************/
      {
        id: "qual_mechanics",
        section: "3. Qualifying & Needs Analysis ‚Äì Scenario Development",
        title: "Pipeline mechanics",
        subtitle: "Define what 'qualified' really means for your team.",
        fields: [
          {
            name: "qualified_lead",
            label: "What makes a lead qualified in your pipeline?",
            type: "textarea",
            required: false,
            placeholder: "Budget, authority, need, timeline, technical fit..."
          },
          {
            name: "qual_info_before_proposal",
            label: "What specific information must a rep uncover before drafting a proposal?",
            type: "textarea",
            required: false,
            placeholder: "Volume, specs, timing, decision process, success metrics..."
          },
          {
            name: "qual_minimum_info",
            label: "What is the minimum viable information needed to price or scope a project?",
            type: "textarea",
            required: false,
            placeholder: "The bare minimum that still leads to good proposals."
          }
        ]
      },
      {
        id: "qual_bottlenecks",
        section: "3. Qualifying & Needs Analysis ‚Äì Scenario Development",
        title: "Where reps get stuck",
        subtitle: "We‚Äôll build practice around your real-world friction points.",
        fields: [
          {
            name: "qual_stuck",
            label: "Where do reps get stuck most frequently in early stages?",
            type: "textarea",
            required: false,
            placeholder: "Early discovery, technical scoping, stakeholder mapping..."
          },
          {
            name: "qual_stall_causes",
            label: "What causes leads to stall before moving to proposal review?",
            type: "textarea",
            required: false,
            placeholder: "Internal delays, budget uncertainty, competing priorities..."
          },
          {
            name: "qual_top_mistakes",
            label: "What are the top three mistakes reps make during qualification?",
            type: "textarea",
            required: false,
            placeholder: "Example: jumping to solution, not defining success, weak next steps..."
          }
        ]
      },
      {
        id: "qual_pain_points",
        section: "3. Qualifying & Needs Analysis ‚Äì Scenario Development",
        title: "Pain points, motivations & competitors",
        subtitle: "Why customers switch and who they compare you to.",
        fields: [
          {
            name: "qual_switch_reasons",
            label: "Why do customers switch suppliers?",
            type: "textarea",
            required: false,
            placeholder: "Service failures, quality issues, cost volatility, misalignment..."
          },
          {
            name: "qual_early_objections",
            label: "What common objections or brush-offs do reps face early?",
            type: "textarea",
            required: false,
            placeholder: "\"We‚Äôre happy with our current supplier\", \"Send me something\", etc."
          },
          {
            name: "qual_volatility_mentions",
            label: "How often do buyers mention supply chain volatility, resin variability, capacity, timeline, or changeovers?",
            type: "textarea",
            required: false,
            placeholder: "Any specific language we should mirror in scenarios?"
          },
          {
            name: "qual_competitors_early",
            label: "Which competitors are mentioned by name in early calls?",
            type: "textarea",
            required: false,
            placeholder: "What do buyers like about them? Where do they fall short?"
          },
          {
            name: "qual_decision_criteria",
            label: "What is the #1 reason customers choose FirmaPak over competitors, and the #1 reason they walk away?",
            type: "textarea",
            required: false,
            placeholder: "Summarize the real decision criteria in your customers‚Äô words."
          },
          {
            name: "qual_notes",
            label: "Notes for Qualifying & Needs Analysis.",
            type: "textarea",
            required: false,
            placeholder: "Any specific calls we should base a scenario on."
          },
          {
            name: "qual_additional_questions",
            label: "Additional questions you want to explore about qualification.",
            type: "textarea",
            required: false,
            placeholder: "Other angles we should bring into early-stage practice."
          }
        ]
      },

      /************ 4. PROPOSAL REVIEW TO CLOSE ************/
      {
        id: "proposal_process",
        section: "4. Proposal Review to Close ‚Äì Scenario Development",
        title: "Proposal process",
        subtitle: "Clarify what happens when you present proposals.",
        fields: [
          {
            name: "proposal_copies",
            label: "Can we get copies of four proposals in different verticals that did not close?",
            type: "textarea",
            required: false,
            placeholder: "Where they‚Äôre stored, who can grant access, and preferred sharing method."
          },
          {
            name: "proposal_delivery",
            label: "How are proposals typically delivered? (Email, video call, in person?)",
            type: "textarea",
            required: false,
            placeholder: "Describe the most common flow."
          },
          {
            name: "proposal_format",
            label: "What is the format or style?",
            type: "textarea",
            required: false,
            placeholder: "Single option, multiple options, volume incentives, T&Cs layout, etc."
          }
        ]
      },
      {
        id: "proposal_negotiation",
        section: "4. Proposal Review to Close ‚Äì Scenario Development",
        title: "Negotiation dynamics & decision makers",
        subtitle: "What needs to be practiced during walkthroughs and negotiations.",
        fields: [
          {
            name: "proposal_negotiated_elements",
            label: "What elements of proposals do buyers negotiate most?",
            type: "textarea",
            required: false,
            placeholder: "Price, payment terms, volume, lead times, changeover costs..."
          },
          {
            name: "proposal_scrutiny",
            label: "Where do buyers scrutinize details or pricing?",
            type: "textarea",
            required: false,
            placeholder: "Specific pages, clauses, or assumptions they push back on."
          },
          {
            name: "proposal_stage_objections",
            label: "What objections arise most frequently at this stage?",
            type: "textarea",
            required: false,
            placeholder: "Risk, implementation effort, switching cost, internal politics..."
          },
          {
            name: "proposal_engagement_loss",
            label: "Where do reps tend to lose buyer engagement during the walkthrough?",
            type: "textarea",
            required: false,
            placeholder: "Sections, slides, or moments that consistently stall momentum."
          },
          {
            name: "proposal_closing_techniques",
            label: "How do you pre or trial close or use techniques to tie down deals?",
            type: "textarea",
            required: false,
            placeholder: "Specific language or approaches you‚Äôd like to practice or refine."
          },
          {
            name: "proposal_post_signature",
            label: "What is the next action after receiving a signed deal or PO?",
            type: "textarea",
            required: false,
            placeholder: "Handoff, kickoff, implementation, and who is involved."
          },
          {
            name: "proposal_decision_makers",
            label: "Who makes the final decision? Is it the same contact from the beginning, or additional stakeholders?",
            type: "textarea",
            required: false,
            placeholder: "Final approvers, influencers, and how they enter the process."
          },
          {
            name: "proposal_notes",
            label: "Notes for Proposal Review to Close.",
            type: "textarea",
            required: false,
            placeholder: "Any specific deals we should mirror end-to-end."
          },
          {
            name: "proposal_additional_questions",
            label: "Additional questions you want to explore about proposal review.",
            type: "textarea",
            required: false,
            placeholder: "Other closing situations you‚Äôd like to simulate."
          }
        ]
      },

      /************ 5. VISIBILITY OF KEY MOMENTS ************/
      {
        id: "visibility",
        section: "5. Determine Visibility of Key Moments",
        title: "Key Moment visibility",
        subtitle: "Clarify who can see recorded Key Moments inside Virtual Instinct.",
        fields: [
          {
            name: "visibility_preference",
            label: "What is FirmaPak‚Äôs preference regarding Key Moment visibility?",
            type: "textarea",
            required: false,
            placeholder: "Private to reps, visible to team, leadership-only, or a mix."
          },
          {
            name: "visibility_confidential_topics",
            label: "Are there topics or practice moments that should remain confidential?",
            type: "textarea",
            required: false,
            placeholder: "Sensitive accounts, pricing structures, strategic initiatives..."
          },
          {
            name: "visibility_leadership_access",
            label: "Will leadership want access to all clips or selected clips?",
            type: "textarea",
            required: false,
            placeholder: "Who should see what, and under which conditions."
          },
          {
            name: "visibility_notes",
            label: "Notes for Key Moment visibility.",
            type: "textarea",
            required: false,
            placeholder: "Any internal guidelines or compliance constraints."
          }
        ]
      },

      /************ 6. VIRTUAL IMPROV PROGRAM ************/
      {
        id: "improv_program",
        section: "6. Pre-Schedule Virtual Improv Program",
        title: "Scheduling weekly improv-based sessions",
        subtitle: "Reinforce skills developed in scenarios with consistent practice.",
        fields: [
          {
            name: "improv_days_times",
            label: "What days/times work best for the team?",
            type: "textarea",
            required: false,
            placeholder: "Preferred time zones, days of the week, and session length."
          },
          {
            name: "improv_notes",
            label: "Notes for Virtual Improv scheduling.",
            type: "textarea",
            required: false,
            placeholder: "Busy seasons, blackout dates, travel-heavy periods, etc."
          }
        ]
      },

      /************ 7. END-OF-PERIOD DEBRIEF ************/
      {
        id: "debrief",
        section: "7. Pre-Schedule End of Active Practice Period Debrief",
        title: "End-of-practice debrief",
        subtitle: "Review outcomes, Key Moments, progression, and next steps.",
        fields: [
          {
            name: "debrief_attendees",
            label: "Who should attend the debrief?",
            type: "textarea",
            required: false,
            placeholder: "Sales leaders, enablement, reps, operations, etc."
          },
          {
            name: "debrief_outcomes",
            label: "What outcomes matter most to measure success?",
            type: "textarea",
            required: false,
            placeholder: "Behavior change, pipeline movement, win rates, deal quality..."
          },
          {
            name: "debrief_recap",
            label: "Should a written or video recap be included?",
            type: "textarea",
            required: false,
            placeholder: "Preferred recap format and who it should be shared with."
          },
          {
            name: "debrief_notes",
            label: "Final notes or anything we didn‚Äôt ask that you want us to know.",
            type: "textarea",
            required: false,
            placeholder: "Use this space to capture anything else on your mind."
          }
        ]
      }
    ];

    /********************************************************
     * STATE & DOM REFS
     ********************************************************/
    let currentStepIndex = 0;
    const answers = {};

    const stepHeaderEl = document.getElementById("step-header");
    const fieldsContainerEl = document.getElementById("fields-container");
    const progressBarEl = document.getElementById("progress-bar");
    const progressTextEl = document.getElementById("progress-text");
    const backBtn = document.getElementById("back-btn");
    const nextBtn = document.getElementById("next-btn");
    const statusEl = document.getElementById("status");
    const consultationSection = document.getElementById("consultation-section");
    const startBtn = document.getElementById("start-btn");

    /********************************************************
     * RENDERING
     ********************************************************/
    function renderStep() {
      const step = steps[currentStepIndex];
      const total = steps.length;
      const stepNumber = currentStepIndex + 1;

      stepHeaderEl.innerHTML = `
        <div class="step-label">${step.section}</div>
        <h3 class="step-title">${step.title}</h3>
        <p class="step-subtitle">${step.subtitle || ""}</p>
      `;

      fieldsContainerEl.innerHTML = "";
      step.fields.forEach(field => {
        const wrapper = document.createElement("div");
        wrapper.className = "field-group";

        const fieldId = `field_${field.name}`;
        let labelHtml = `<label for="${fieldId}">${field.label}`;
        if (field.required) labelHtml += ` <span class="required-badge">*</span>`;
        labelHtml += `</label>`;

        let helperHtml = field.helper ? `<small>${field.helper}</small>` : "";

        const existingValue = answers[field.name] || "";
        let controlHtml = "";

        if (field.type === "textarea") {
          controlHtml = `
            <textarea
              id="${fieldId}"
              class="field-textarea"
              name="${field.name}"
              placeholder="${field.placeholder || ""}"
            >${existingValue}</textarea>
          `;
        } else {
          controlHtml = `
            <input
              id="${fieldId}"
              class="field-input"
              type="${field.type}"
              name="${field.name}"
              placeholder="${field.placeholder || ""}"
              value="${existingValue}"
            />
          `;
        }

        wrapper.innerHTML = labelHtml + helperHtml + controlHtml;
        fieldsContainerEl.appendChild(wrapper);
      });

      const percent = (stepNumber / total) * 100;
      progressBarEl.style.width = percent.toFixed(1) + "%";
      progressTextEl.textContent = `Step ${stepNumber} of ${total}`;

      backBtn.disabled = currentStepIndex === 0;
      nextBtn.textContent = currentStepIndex === total - 1 ? "Submit ‚Üí" : "Next ‚Üí";

      statusEl.textContent = "";
      statusEl.className = "status-message status-neutral";
    }

    function collectCurrentStepValues() {
      const step = steps[currentStepIndex];
      let valid = true;
      let firstInvalidField = null;

      step.fields.forEach(field => {
        const fieldId = `field_${field.name}`;
        const el = document.getElementById(fieldId);
        if (!el) return;

        const value = el.value.trim();
        answers[field.name] = value;

        if (field.required && !value) {
          valid = false;
          if (!firstInvalidField) firstInvalidField = el;
        }

        if (field.required && field.type === "email" && value) {
          const emailOk = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value);
          if (!emailOk) {
            valid = false;
            if (!firstInvalidField) firstInvalidField = el;
          }
        }
      });

      if (!valid) {
        statusEl.textContent = "Please complete the required fields on this step.";
        statusEl.className = "status-message status-error";
        if (firstInvalidField) firstInvalidField.focus();
        return false;
      }

      return true;
    }

    /********************************************************
     * SUBMIT ‚Üí ZAPIER WEBHOOK + SUCCESS MESSAGE
     ********************************************************/
    async function handleSubmit() {
      // Make sure the current step is saved & validated
      if (!collectCurrentStepValues()) return;

      const payload = {
        meta: {
          source: "FirmaPak Scenario Development Consultation",
          submittedAt: new Date().toISOString(),
          userAgent: navigator.userAgent
        },
        answers: { ...answers }
      };

      statusEl.textContent = "Submitting your responses...";
      statusEl.className = "status-message status-neutral";

      if (!WEBHOOK_URL) {
        statusEl.textContent =
          "No webhook URL configured. Please contact the Virtual Instinct team.";
        statusEl.className = "status-message status-error";
        return;
      }

      try {
        // Use text/plain to avoid CORS issues but still send JSON
        const res = await fetch(WEBHOOK_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain" },
          body: JSON.stringify(payload)
        });

        if (!res.ok) throw new Error("Non-200 response from Zapier");

        statusEl.textContent =
          "Success! Your consultation responses have been securely submitted to the Virtual Instinct team. You may close this tab.";
        statusEl.className = "status-message status-success";
        nextBtn.disabled = true;
        backBtn.disabled = true;
      } catch (err) {
        console.error("Webhook submission failed:", err);
        statusEl.textContent =
          "We couldn‚Äôt submit the form. Please refresh and try again, or email your Virtual Instinct contact.";
        statusEl.className = "status-message status-error";
      }
    }

    /********************************************************
     * EVENTS
     ********************************************************/
    backBtn.addEventListener("click", () => {
      if (currentStepIndex === 0) return;
      if (!collectCurrentStepValues()) return;
      currentStepIndex -= 1;
      renderStep();
    });

    nextBtn.addEventListener("click", () => {
      const isLastStep = currentStepIndex === steps.length - 1;
      if (isLastStep) {
        handleSubmit();
      } else {
        if (!collectCurrentStepValues()) return;
        currentStepIndex += 1;
        renderStep();
      }
    });

    startBtn.addEventListener("click", () => {
      consultationSection.classList.remove("hidden");
      startBtn.disabled = true;
      startBtn.textContent = "Consultation Started";
      renderStep();
    });
  </script>
</body>
</html>

